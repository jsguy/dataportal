<html>
<head>
	<title></title>
	<script type="text/javascript" src="js/jsondiffpatch.js"></script>
	<script type="text/javascript" src="../lib/sockjs-1.0.3.js"></script>
	<script type="text/javascript" src="js/jquery-1.11.3.js"></script>
	<script type="text/javascript" src="../lib/hash.js"></script>
	<script type="text/javascript" src="js/knockout-3.3.0.js"></script>
	<script type="text/javascript" src="js/knockout.stopbinding.js"></script>
	<script type="text/javascript" src="../lib/adaptors/knockout.mapping-2.4.1.js"></script>
	<script type="text/javascript" src="../lib/adaptors/knockout.dataportal-0.0.1.js"></script>
    <!-- Set the url parameter to the IP address or URL of your server -->
    <!--<script src="../lib/dataportal.js?url=http://local.mac:32827/dataPortal"></script>-->
    <script src="../lib/dataportal.js?url=http://192.168.3.20:32827/dataPortal"></script>
	<link rel="stylesheet" type="text/css" href="css/style.css">
</head>
<body>

<h1>Dataportal dynamic data example</h1>

<table class="data-table">
    <thead>
        <th>Time</th>
        <th>Name</th>
        <th>text</th>
    </thead>
    <tbody data-bind="foreach: rows">
        <tr>
            <td data-bind="text: time()"></td>
            <td data-bind="text: name()"></td>
            <td data-bind="text: text()"></td>
        </tr>
    </tbody>
</table>

<script>
//	Data model
var DataRow = function(name, text, time) {
	var timeObj = new Date((new Date()));
    this.name = ko.observable(name);
    this.text = ko.observable(text);
    this.time = ko.observable(timeObj.getHours() + ":" + (timeObj.getMinutes()<10?'0':'') + timeObj.getMinutes());
}, ViewModel = function() {
    var me = this;
    me.rows = ko.observableArray([]);
},vm = new ViewModel();
ko.applyPortalBindings({
    topic: "dataTopic",
    model: vm,
    element: $(".js-chats").get(0),
    //  Set mapping options to use our DataRow constructor
    mappingOptions: {
        'rows': {
            create: function(options) {
                return new DataRow(options.data.name, options.data.text, options.data.time);
            }
        }
    }
});
</script>

</body>
</html>